import{j as e,C as $,a as ee,P as re,E as te,L as Y,e as ne,V as t,u as se,b as oe,d as ie,f as N,g as ae,h as ce,R as b,B as k,i as le,M as ue,k as de}from"./three.js";import{r as n}from"./vendor.js";const me="/assets/card.glb",pe="/assets/profilepic.png";ne({MeshLineGeometry:ue,MeshLineMaterial:de});function ge({position:E=[0,0,30],gravity:M=[0,-40,0],fov:f=35,transparent:u=!1}){const[a,c]=n.useState(!1),[d,s]=n.useState(!1);return n.useEffect(()=>{(()=>{const h=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),z=navigator.deviceMemory&&navigator.deviceMemory<4,L=navigator.hardwareConcurrency&&navigator.hardwareConcurrency<4;(h||z||L)&&s(!0)})()},[]),a||d?e.jsx("div",{className:"w-full h-screen"}):e.jsx("div",{className:"relative z-0 w-full h-screen flex justify-center items-center transform scale-100 origin-center",children:e.jsxs($,{camera:{position:E,fov:f},gl:{alpha:u,antialias:!1,powerPreference:"high-performance"},onCreated:({gl:o})=>{o.setClearColor(new ee(0),u?0:1),o.setPixelRatio(Math.min(window.devicePixelRatio,2))},onError:()=>c(!0),children:[e.jsx("ambientLight",{intensity:10}),e.jsx(re,{gravity:M,timeStep:1/30,children:e.jsx(fe,{})}),e.jsxs(te,{blur:.75,background:!1,children:[e.jsx(Y,{intensity:2.5,color:"white",position:[0,-1,5],rotation:[0,0,Math.PI/3],scale:[50,.1,1]}),e.jsx(Y,{intensity:2.5,color:"white",position:[-1,-1,1],rotation:[0,0,Math.PI/3],scale:[50,.1,1]})]})]})})}function fe({maxSpeed:E=50,minSpeed:M=0}){const f=n.useRef(null),u=n.useRef(null),a=n.useRef(null),c=n.useRef(null),d=n.useRef(null),s=n.useRef(null),o=new t,h=new t,z=new t,L=new t,w={type:"dynamic",canSleep:!0,colliders:!1,angularDamping:4,linearDamping:4},{nodes:C,materials:R}=se(me),x=oe(pe);x.flipY=!1,x.repeat.set(1.25,1.25),x.offset.set(.3,.15),x.center.set(.5,.5),x.rotation=0;const[y]=n.useState(()=>new ie([new t,new t,new t,new t,new t])),[m,F]=n.useState(!1),[T,B]=n.useState(!1),[q,Q]=n.useState(()=>typeof window<"u"?window.innerWidth<1024:!1);return n.useEffect(()=>{const r=()=>{Q(window.innerWidth<1024)};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),N(u,a,[[0,0,0],[0,0,0],1]),N(a,c,[[0,0,0],[0,0,0],1]),N(c,d,[[0,0,0],[0,0,0],1]),ae(d,s,[[0,0,0],[0,1.45,0]]),n.useEffect(()=>{if(T)return document.body.style.cursor=m?"grabbing":"grab",()=>{document.body.style.cursor="auto"}},[T,m]),n.useEffect(()=>{var r;if((r=f.current)!=null&&r.geometry){const S=[new t(0,0,0),new t(0,-1,0)];f.current.geometry.setPoints(S)}},[]),ce((r,S)=>{var I,G,D,O,A,U,W,J;if(m&&typeof m!="boolean"&&(o.set(r.pointer.x,r.pointer.y,.5).unproject(r.camera),L.copy(o).sub(r.camera.position).normalize(),o.add(L.multiplyScalar(r.camera.position.length())),[s,a,c,d,u].forEach(l=>{var p;return(p=l.current)==null?void 0:p.wakeUp()}),(I=s.current)==null||I.setNextKinematicTranslation({x:o.x-m.x,y:o.y-m.y,z:o.z-m.z})),u.current&&a.current&&c.current&&d.current&&s.current&&((G=f.current)!=null&&G.geometry)){[a,c].forEach(i=>{var H,K;const g=(K=(H=i.current).translation)==null?void 0:K.call(H);if(!g)return;i.current.lerped||(i.current.lerped=new t().copy(g));const Z=i.current.lerped.distanceTo(g),_=Math.max(.1,Math.min(1,Z));i.current.lerped.lerp(g,S*(M+_*(E-M)))});const l=(O=(D=s.current).translation)==null?void 0:O.call(D),p=(U=(A=d.current).translation)==null?void 0:U.call(A),j=c.current.lerped,P=a.current.lerped,v=(J=(W=u.current).translation)==null?void 0:J.call(W);if(!l||!p||!j||!P||!v||((...i)=>i.some(g=>!Number.isFinite(g)))(l.x,l.y,l.z,p.x,p.y,p.z,j.x,j.y,j.z,P.x,P.y,P.z,v.x,v.y,v.z))return;const X=new t(l.x,l.y+.25,l.z);y.points[0].copy(X),y.points[1].copy(p),y.points[2].copy(j),y.points[3].copy(P),y.points[4]=new t().copy(v);const V=y.getPoints(32);V.every(i=>Number.isFinite(i.x)&&Number.isFinite(i.y)&&Number.isFinite(i.z))&&f.current.geometry.setPoints(V),h.copy(s.current.angvel()),z.copy(s.current.rotation()),s.current.setAngvel({x:h.x,y:h.y-z.y*.25,z:h.z})}}),y.curveType="chordal",e.jsxs(e.Fragment,{children:[e.jsxs("group",{position:[0,6,0],children:[e.jsx(b,{ref:u,...w,type:"fixed",position:[0,0,0]}),e.jsx(b,{position:[0,-.5,0],ref:a,...w,type:"dynamic",children:e.jsx(k,{args:[.1]})}),e.jsx(b,{position:[0,-1,0],ref:c,...w,type:"dynamic",children:e.jsx(k,{args:[.1]})}),e.jsx(b,{position:[0,-1.5,0],ref:d,...w,type:"dynamic",children:e.jsx(k,{args:[.1]})}),e.jsxs(b,{position:[0,-2,0],ref:s,...w,type:m?"kinematicPosition":"dynamic",children:[e.jsx(le,{args:[.8,1.125,.01]}),e.jsx("group",{scale:1.2,position:[0,-1.2,-.05],onPointerOver:()=>B(!0),onPointerOut:()=>B(!1),onPointerUp:r=>{r.target.releasePointerCapture(r.pointerId),F(!1)},onPointerDown:r=>{r.target.setPointerCapture(r.pointerId),F(new t().copy(r.point).sub(o.copy(s.current.translation())))},children:C&&R?e.jsxs(e.Fragment,{children:[e.jsx("mesh",{geometry:C.card.geometry,children:e.jsx("meshPhysicalMaterial",{map:x,clearcoat:1,clearcoatRoughness:.15,roughness:.9,metalness:.8})}),e.jsx("mesh",{geometry:C.clip.geometry,material:R.metal,"material-roughness":.3}),e.jsx("mesh",{geometry:C.clamp.geometry,material:R.metal})]}):e.jsxs("mesh",{children:[e.jsx("boxGeometry",{args:[1.6,2.25,.02]}),e.jsx("meshPhysicalMaterial",{color:"#ffffff",clearcoat:1,clearcoatRoughness:.15,roughness:.9,metalness:.8})]})})]})]}),e.jsxs("mesh",{ref:f,children:[e.jsx("meshLineGeometry",{points:[new t(0,0,0),new t(0,-1,0)]}),e.jsx("meshLineMaterial",{color:"black",depthTest:!0,resolution:q?[1e3,2e3]:[1e3,1e3],lineWidth:1,transparent:!1,opacity:1})]})]})}export{ge as default};
